@using myRaiCommonModel

@model ModuloVM

<div class="block block-themed block-transparent remove-margin-b">

    <div class="block-header">
        <label class="rai-font-modal-heading">
            ESERCIZIO DIRITTO SMART WORKING
        </label>
        <div class="block-options">
            <button id="@(Model.WidgetId)_ChiudiModale" data-dismiss="modal" class="btn btn-action-icon"><i class="glyphicon glyphicon-remove"></i></button>
        </div>
    </div>

    <div class="row no-margin-left-right">
        <!-- Colonna -->
        <div class="col-sm-12 no-pad-left no-pad-right border-right ">
            <div class="block-content block-content-full boxdate" style="margin-bottom: 0px; padding-bottom:5px; overflow-y: auto; height: 80vh">
                <div class="row">
                    <div class="col-xs-12" id="modulo-content-body" style="margin-left:5%; width:90%;">
                        <br />
                        <br />
                        <div class="row">
                            <span class="rai-font-text-heading">
                                Manifestazione del diritto a rendere la prestazione lavorativa in modalità di lavoro agile, ai sensi dell’art. 39 del D.L. 18/2020, conv. nella L. n. 27/2020 e dell’art. 90 del D.L. 34/2020
                            </span>
                        </div>
                        <br />
                        <br />
                        <div class="row">
                            <span class="rai-font-text-heading">
                                @{
                                    string txSott = "";
                                    if (Model.Sesso == "M")
                                    {
                                        txSott = "Io sottoscritto";
                                    }
                                    else
                                    {
                                        txSott = "Io sottoscritta";
                                    }
                                }
                                @(txSott) @(Model.Nominativo), matricola aziendale n. @(Model.Matricola) , intendo esercitare, con l'invio del presente modulo, il mio diritto allo svolgimento dell’attività lavorativa nella modalità del lavoro agile (smart working) per tutta la <u>durata dello stato di emergenza dichiarato.</u><sup>1</sup>
                            </span>
                        </div>
                        <br />
                        <div class="row">
                            <span class="rai-font-text-heading">
                                Pertanto, sotto la mia responsabilità, consapevole delle possibili conseguenze in caso di dichiarazioni non veritiere ad esito dei controlli che potranno essere eseguiti dall’Azienda, dichiaro a questi fini di appartenere ad una o più di queste categorie:
                            </span>
                        </div>
                        <br />
                        @{
                            string txCheckedTrue = "checked=\"checked\"";
                        }
                        <div class="row">
                            <div class="rai-checkbox-container ">
                                <div class="col-sm-12 no-padding">
                                    <div class="rai-checkbox">
                                        <input id="Scelta1" type="checkbox" data-check-group="scelta-filter" value="1" @(Model.Scelta1 ? txCheckedTrue : "") />
                                        <label class="rai-font-md" for="Scelta1">lavoratore disabile in condizione di gravità accertata, ai sensi dell’art. 3, comma 3, L. n. 104/1992;</label>
                                    </div>
                                </div>
                                <br />
                                <br />
                                <div class="col-sm-12 no-padding">
                                    <div class="rai-checkbox">
                                        <input id="Scelta2" type="checkbox" data-check-group="scelta-filter" value="2" @(Model.Scelta2 ? txCheckedTrue : "") />
                                        <label class="rai-caption" for="Scelta2"><span>lavoratore che abbia nel proprio “nucleo familiare” un soggetto disabile in condizione di gravità accertata, ai sensi dell’art. 3, comma 3, L. n. 104/1992;<sup>2</sup></span></label>
                                    </div>
                                </div>
                                <br />
                                <br />
                                <div class="col-sm-12 no-padding">
                                    <div class="rai-checkbox">
                                        <input id="Scelta3" type="checkbox" data-check-group="scelta-filter" value="3" @(Model.Scelta3 ? txCheckedTrue : "") />
                                        <label class="rai-caption" for="Scelta3">lavoratore immunodepresso;</label>
                                    </div>
                                </div>
                                <br />
                                <br />
                                <div class="col-sm-12 no-padding">
                                    <div class="rai-checkbox">
                                        <input id="Scelta4" type="checkbox" data-check-group="scelta-filter" value="4" @(Model.Scelta4 ? txCheckedTrue : "") />
                                        <label class="rai-caption" for="Scelta4"><span>lavoratore che convive con "familiare"<sup>3</sup>immunodepresso;</span></label>
                                    </div>
                                </div>
                                @*<br />
                                    <br />
                                    <div class="col-sm-12 no-padding">
                                        <div class="rai-checkbox">
                                            <input id="Scelta5" type="checkbox" data-check-group="scelta-filter" value="5" @(Model.Scelta5 ? txCheckedTrue : "") />
                                            <label class="rai-caption" for="Scelta5">
                                                genitore di figlio di età non superiore a 14 anni (fino a 13 anni e 364 giorni).
                                                A tal fine, dichiaro che l’altro genitore non è beneficiario di strumenti a sostegno del reddito per sospensione o
                                                cessazione di attività (es. Cassa integrazione e tutele assimilate, indennità di disoccupazione, DIS/COLL, ecc.),
                                                disoccupato od in condizione di non occupazione (es. casalinga/o).
                                            </label>
                                        </div>
                                    </div>*@
                            </div>
                        </div>
                        <br />
                        <br />
                        <div class="row">
                            @*<span class="rai-font-text-heading">
                                    Mi impegno a comunicare, tempestivamente, qualsiasi variazione di quanto oggetto della presente richiesta,
                                    tenuto conto che il venir meno di uno dei requisiti legittimanti comporta la decadenza dal diritto in questione
                                    (es. compimento del 14-esimo anno di età del figlio, mancata conferma dello stato di grave disabilità del soggetto da assistere, ecc.).
                                </span>*@
                            <span class="rai-font-text-heading">
                                Mi impegno a comunicare, tempestivamente, qualsiasi variazione di quanto oggetto della presente richiesta,
                                tenuto conto che il venir meno di uno dei requisiti legittimanti comporta la decadenza dal diritto in questione
                                (es. mancata conferma dello stato di grave disabilità del soggetto da assistere, ecc.).
                            </span>
                        </div>
                        <br />
                        <div class="row">
                            <span class="rai-font-text-heading">
                                Sono consapevole che il diritto all’effettuazione della prestazione in lavoro agile è comunque subordinato alla verifica di compatibilità
                                della mansione con tale modalità, anche alla luce dell’assetto organizzativo e/o produttivo dell’Azienda.
                            </span>
                        </div>
                        <br />
                        <div class="row">
                            <span class="rai-font-text-heading">
                                Sono infine disponibile a presentare ogni utile documentazione (es. certificato medico che attesti immunodepressione,
                                certificato di residenza/stato di famiglia, dichiarazione sullo status lavorativo dell’altro genitore, ecc.),
                                che potrà essermi eventualmente richiesta, ivi incluso, ove necessario, l’eventuale consenso al trattamento ove si
                                tratti di dati di soggetti terzi ai sensi dell’attuale disciplina sulla privacy, non già noti all’Azienda.
                            </span>
                        </div>
                        <br />
                        <br />
                        <br />
                        <hr />
                        <div class="row">
                            <span class="rai-font-sm-bold">
                                <sup>1</sup> Attualmente, lo stato di emergenza è stato dichiarato fino al 15 ottobre 2020. Tuttavia, fermo restando quel termine per le altre categorie di aventi diritto, il DL 83/2020 ha previsto per i genitori con figli under 14 la possibilità di esercitare il diritto allo smart working solo fino al 14 settembre 2020.
                            </span>
                        </div>
                        <div class="row">
                            <span class="rai-font-sm-bold">
                                <sup>2</sup> La "convivenza" deve essere provata con un certificato dello stato di famiglia che evidenzi la comune residenza. Il "nucleo familiare" con cui il disabile deve convivere e' quello composto dall'insieme delle persone che risultano dallo stato di famiglia.
                            </span>
                        </div>
                        <div class="row">
                            <span class="rai-font-sm-bold">
                                <sup>3</sup> Per "familiare" si intende il componente la famiglia anagrafica, ovvero insieme di persone legate da vincoli di matrimonio, unione civile, parentela, affinita', adozione, tutela o vincoli affettivi, coabitanti ed aventi dimora abituale nello stesso comune. Anch'esso si prova con il certificato stato di famiglia.
                            </span>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <!-- Fine colonna -->
    </div>
</div>
<div class="modal-footer" style="width:100%;height:60px;position:absolute;bottom:0px;text-align:center;border-top:none;">
    <button type="button" class="btn btn-primary" onclick="ConfermaScelta();">Conferma</button>
    <button type="button" class="btn btn-secondary" data-dismiss="modal">Annulla</button>
</div>



<script type="text/javascript">

    function ConfermaScelta() {
        var almenoUnoSelezionato = $('input[data-check-group="scelta-filter"]:checked').length > 0;

        if (typeof almenoUnoSelezionato === "undefined" ||
            almenoUnoSelezionato == null ||
            almenoUnoSelezionato == "" ||
            almenoUnoSelezionato == false) {
            swal({
                title: 'Scelta obbligatoria',
                text: 'E\' necessario selezionare una delle opzioni',
                type: 'error',
                confirmButtonText: 'Ok',
                confirmButtonClass: 'btn btn-lg btn-primary',
                buttonsStyling: false
            });
            return false;
        }

        var messaggio = "Sicuro di voler continuare?<br>Si ricorda che non è possibile modificare la scelta.";

        swal({
            title: 'Conferma selezione',
            html:
                '<div id="swal2-content" class="swal2-content" style="display: block;">' + messaggio + '</div>' +
                '<br>' +
                '<div class="rai-btn-fill">'+
                '<a id="btnConferma" class="btn rai-btn-primary full-width" style="padding: 12px 6px;">Si</a>' +
                '<a id="btnNo" class="btn rai-btn-secondary full-width">No</a>' +
                '</div> ' +
                '<button type="button" class="swal2-confirm btn btn-primary btn-lg" style="display: none;">Salva</button>' +
                '<button type="button" class="swal2-cancel" style="display: none;">Cancel</button>' +
                '<span class="swal2-close" style="display: none;">×</span>',
            showCloseButton: false,
            showCancelButton: false,
            showConfirmButton: false,
            confirmButtonText: 'Salva',
            confirmButtonClass: 'btn btn-primary btn-lg',
            buttonsStyling: false,
        });

        $('#btnNo').on('click', function () {
            $('button[type="button"][class="swal2-cancel"]').click();
        });

        $('#btnConferma').on('click', function () {
            if (typeof almenoUnoSelezionato === "undefined" ||
                almenoUnoSelezionato == null ||
                almenoUnoSelezionato == "" ||
                almenoUnoSelezionato == false ) {
                swal({
                    title: 'Scelta oobligatoria',
                    text: 'E\' necessario selezionare una delle opzioni',
                    type: 'error',
                    confirmButtonText: 'Ok',
                    confirmButtonClass: 'btn btn-lg btn-primary',
                    buttonsStyling: false
                });
                return false;
            }

            var selezione = "";
            $('input[data-check-group="scelta-filter"]:checked').each(function () {
                selezione += $(this).val() + ";";
            });

            $.ajax({
                url: '@Url.Action("SalvaScelta", "Moduli")',
                type: "POST",
                dataType: "html",
                data: {
                    scelta: selezione
                },
                success: function (data) {
                    switch (data) {
                        case "OK":
                            $('#@(Model.WidgetId)_ChiudiModale').click();
                            $.ajax({
                                type: "POST",
                                cache: false,
                                async: false,
                                contentType: "application/json; charset=utf-8",
                                dataType: 'html',
                                url: '@Url.Action( "RicaricaWidget" , "Moduli")',
                                success: function (data) {
                                    $('#ContainerDiv_WdgSmartWorking').html(data);
                                },
                                error: function (parm1, parm2, parm3) {
                                }
                            });
                            swal('MODULO PER L’ESERCIZIO DEL DIRITTO ALLO SMART WORKING', "Modulo compilato con successo", "success");
                            break;
                        default:
                            swal("Oops...", data, 'error');
                            break;
                    }
                },
                error: function (parm1, parm2, parm3) {
                }
            });

        });
    }
</script>