@model myRaiCommonModel.Bonus100Model
<div class="block block-themed block-transparent remove-margin-b">
    <div class="block-header bg-cdf" style="height: 58px;">
        <ul class="block-options visible-xs">
            <li>
                <button data-dismiss="modal" type="button"><span aria-hidden="true">×</span></button>
            </li>
        </ul>
        <h4 class="lead" style="display:inline;float: left; margin: -3px 0 0 0px; font-size: 2.1rem; color: #fff;">DICHIARAZIONE PER LA FRUIZIONE DEL PREMIO RICONOSCIUTO AI LAVORATORI DIPENDENTI </h4>
        <h4 class="lead" id="periodo-scroll" style="font-weight:500;display:inline;float: left;margin: -3px 0 0 10px;font-size: 2.1rem;color: #fff;"></h4>
        <button id="ChiudiModale100" type="button" class="close" data-dismiss="modal" aria-label="Chiudi"><span aria-hidden="true">×</span></button>
    </div>
    <div class="row no-margin-left-right">
        <!-- Colonna -->
        <div class="col-sm-12 no-pad-left no-pad-right border-right ">
            <div class="block-content block-content-full boxdate" style="margin-bottom: 0px; padding-bottom:5px;">
                <div class="row">
                    <div class="col-xs-12" id="modulo-content-body" style="margin-left:5%; width:90%;">
                        <br />
                        <br />
                        <div class="row">
                            <span class="rai-font-text-heading">
                                Dichiari ai sensi degli artt.46 e 47 del DPR n.445/2000, di aver percepito, nel corso dell'anno 2019, redditi complessivi da lavoro
                                dipendente (*) per un importo non superiore a 40.000 euro e pertanto di avere diritto all'erogazione del premio?
                            </span>
                        </div>
                        <br />
                        <br />
                        <br />
                        <div class="row">
                            <div class="rai-radio-container ">
                                <div class="col-xs-1"></div>
                                <div class="col-xs-1"></div>
                                <div class="col-xs-1"></div>
                                <div class="col-xs-1"></div>
                                <div class="col-xs-1">
                                    <div class="rai-radio ">
                                        @{
                                            if ( Model.GiaScelto )
                                            {
                                                if ( Model.Scelta1 )
                                                {
                                                    <input type="radio" id="radio1" name="radio100" value="1" checked="checked" readonly="readonly" />
                                                }
                                                else
                                                {
                                                    <input type="radio" id="radio1" name="radio100" value="1" readonly="readonly" disabled="disabled" />
                                                }
                                            }
                                            else
                                            {
                                                if ( Model.Scelta1 )
                                                {
                                                    <input type="radio" id="radio1" name="radio100" value="1" checked="checked" />
                                                }
                                                else
                                                {
                                                    <input type="radio" id="radio1" name="radio100" value="1" />
                                                }
                                            }
                                        }

                                        <label for="radio1" class="rai-font-text-heading">SI</label>
                                    </div>
                                </div>
                                <div class="col-xs-1"></div>
                                <div class="col-xs-1"></div>
                                <div class="col-xs-1">
                                    <div class="rai-radio">
                                        @{
                                            if ( Model.GiaScelto )
                                            {
                                                if ( Model.Scelta2 )
                                                {
                                                    <input type="radio" id="radio2" name="radio100" value="0" checked="checked" readonly="readonly" />
                                                }
                                                else
                                                {
                                                    <input type="radio" id="radio2" name="radio100" value="0" readonly="readonly" disabled="disabled" />
                                                }
                                            }
                                            else
                                            {
                                                if ( Model.Scelta2 )
                                                {
                                                    <input type="radio" id="radio2" name="radio100" value="0" checked="checked" />
                                                }
                                                else
                                                {
                                                    <input type="radio" id="radio2" name="radio100" value="0" />
                                                }
                                            }
                                        }
                                        <label for="radio2" class="rai-font-text-heading">NO</label>
                                    </div>
                                </div>
                                <div class="col-xs-1"></div>
                                <div class="col-xs-1"></div>
                                <div class="col-xs-1"></div>
                                <div class="col-xs-1"></div>
                            </div>
                        </div>
                        <div class="row">
                            <br />
                            <br />
                            <br />
                            <span class="rai-font-text-heading">
                                (*) ai fini del calcolo dell’importo del reddito complessivo da lavoro dipendente si deve tener conto delle seguenti retribuzioni
                                eventualmente percepite: stipendi, cassa integrazione, indennità di disoccupazione, indennità di mobilità, indennità di malattia,
                                indennità di maternità, etc. Tali dati sono contenuti nei punti 1 e/o 2 delle CU 2020 (redditi 2019) rilasciate al dipendente
                                dai sostituti che nel 2019 hanno corrisposto le somme elencate (a titolo esemplificativo, dal datore di lavoro,
                                dall’ente previdenziale, etc). A tali importi vanno aggiunti quelli eventualmente esposti nei punti 455, 456, 463 e 465 della CU 2020,
                                nonché la quota di abbattimento del reddito di lavoro dipendente percepito dai residenti a Campione d’Italia riportata nelle annotazioni
                                con il codice “CA” della CU 2020.
                                Sono invece esplicitamente esclusi dal calcolo i redditi assimilati a quelli di lavoro dipendente (ad es, borse di studio,
                                collaborazioni coordinate e continuative, etc) e le pensioni.
                            </span>
                        </div>
                        @{
                            if ( Model.DataCompilazione.HasValue )
                            {
                                <div class="row">
                                    <br />
                                    <br />
                                    <br />
                                    <br />
                                    <br />
                                    <br />
                                    <span class="rai-font-md-bold">
                                        <i>Modulo compilato e inviato in data @(Model.DataCompilazione.GetValueOrDefault( ).ToString( "dd/MM/yyyy" ))</i>
                                    </span>
                                </div>
                            }
                        }
                    </div>
                </div>
            </div>
        </div>
        <!-- Fine colonna -->
    </div>
</div>
<div class="modal-footer" style="width:100%;height:60px;position:absolute;bottom:0px;text-align:center;border-top:none;">
    @{
        if ( Model.GiaScelto )
        {
            <button type="button" class="btn btn-secondary" data-dismiss="modal">Chiudi</button>
        }
        else
        {
            <button type="button" class="btn btn-primary" onclick="ConfermaScelta();">Conferma</button>
            <button type="button" class="btn btn-secondary" data-dismiss="modal">Annulla</button>
        }
    }
</div>

<script type="text/javascript">

    function ConfermaScelta() {
        var radio = $('input[name="radio100"]:checked').val();

        if (typeof radio === "undefined" ||
            radio == null ||
            radio == "") {
            swal({
                title: 'Scelta obbligatoria',
                text: 'E\' necessario selezionare una delle due opzioni',
                type: 'error',
                confirmButtonText: 'Ok',
                confirmButtonClass: 'btn btn-lg btn-primary',
                buttonsStyling: false
            });
            return false;
        }

        var messaggio = "";

        if (radio == "0") {
            mesaggio = "Hai dichiarato di aver percepito più di 40.000 euro nel corso dell'anno 2019<br>Si ricorda che non è possibile modificare la scelta, continuare?";
        }
        else {
            mesaggio = "Hai dichiarato di aver percepito meno di 40.000 euro nel corso dell'anno 2019<br>Si ricorda che non è possibile modificare la scelta, continuare?";
        }

        swal({
            title: 'Conferma selezione',
            html:
                '<div id="swal2-content" class="swal2-content" style="display: block;">' + mesaggio + '</div>' +
                '<br>' +
                '<div class="rai-btn-fill">'+
                '<a id="btnConferma" class="btn rai-btn-primary full-width" style="padding: 12px 6px;">Si</a>' +
                '<a id="btnNo" class="btn rai-btn-secondary full-width">No</a>' +
                '</div> ' +
                '<button type="button" class="swal2-confirm btn btn-primary btn-lg" style="display: none;">Salva</button>' +
                '<button type="button" class="swal2-cancel" style="display: none;">Cancel</button>' +
                '<span class="swal2-close" style="display: none;">×</span>',
            showCloseButton: false,
            showCancelButton: false,
            showConfirmButton: false,
            confirmButtonText: 'Salva',
            confirmButtonClass: 'btn btn-primary btn-lg',
            buttonsStyling: false,
        });

        $('#btnNo').on('click', function () {
            $('button[type="button"][class="swal2-cancel"]').click();
        });

        $('#btnConferma').on('click', function () {
            if (typeof radio === "undefined" ||
                radio == null ||
                radio == "") {
                swal({
                    title: 'Scelta oobligatoria',
                    text: 'E\' necessario selezionare una delle due opzioni',
                    type: 'error',
                    confirmButtonText: 'Ok',
                    confirmButtonClass: 'btn btn-lg btn-primary',
                    buttonsStyling: false
                });
                return false;
            }

            $.ajax({
                url: '@Url.Action("SalvaScelta", "Bonus")',
                type: "POST",
                dataType: "html",
                data: {
                    scelta: radio
                },
                success: function (data) {
                    var ricarica = false;
                    switch (data) {
                        case "OK":
                            //$('#panelBoxBonus100').hide();
                            $('#btnbonus100Action').text("Visualizza");
                            $("#btnbonus100Action").attr("href", "javascript:showBoxBonus100PDF('@(Model.Anno)','" + radio + "' );");

                            $('#Bonus100SubTitle').text("Compilato ed inviato in data @(DateTime.Now.ToString("dd/MM/yyyy"))");

                            swal('Premio ai lavoratori dipendenti D.L. 18/20', "Modulo compilato con successo", "success");
                            ricarica = true;
                            break;
                        default:
                            swal("Oops...", data, 'error');
                            break;
                    }
                    if (ricarica) {
                        $("#ChiudiModale100").click();
                    }
                },
                error: function (parm1, parm2, parm3) {
                }
            });

        });
    }
</script>